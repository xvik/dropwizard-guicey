
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Dropwizard guice integration">
      
      
      
        <meta name="author" content="Vyacheslav Rusakov">
      
      
        <link rel="canonical" href="https://xvik.github.io/dropwizard-guicey/5.4.0/decomposition/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Decomposition - Dropwizard-guicey</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
        
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-93174150-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#decomposition" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Dropwizard-guicey" class="md-header__button md-logo" aria-label="Dropwizard-guicey" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Dropwizard-guicey
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Decomposition
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/xvik/dropwizard-guicey/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    dropwizard-guicey
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../getting-started/" class="md-tabs__link md-tabs__link--active">
        Getting started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../guide/configuration/" class="md-tabs__link">
        User guide
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../installers/resource/" class="md-tabs__link">
        Installers
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../extras/bom/" class="md-tabs__link">
        Modules
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../examples/authentication/" class="md-tabs__link">
        Examples
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../about/release-notes/" class="md-tabs__link">
        About
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Dropwizard-guicey" class="md-nav__button md-logo" aria-label="Dropwizard-guicey" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Dropwizard-guicey
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/xvik/dropwizard-guicey/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    dropwizard-guicey
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        Getting started
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Getting started" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Getting started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Setup
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        Concepts overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guice/" class="md-nav__link">
        Guice
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../tests/" class="md-nav__link">
        Testing
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Decomposition
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Decomposition
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#guicey-bundle" class="md-nav__link">
    Guicey bundle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dropwizard-bundle" class="md-nav__link">
    Dropwizard bundle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bundle-vs-module" class="md-nav__link">
    Bundle vs Module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bundle-tips" class="md-nav__link">
    Bundle tips
  </a>
  
    <nav class="md-nav" aria-label="Bundle tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uniqueness" class="md-nav__link">
    Uniqueness
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-loaded-bundle" class="md-nav__link">
    Auto-loaded bundle
  </a>
  
    <nav class="md-nav" aria-label="Auto-loaded bundle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auto-load-override" class="md-nav__link">
    Auto load override
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-extensions" class="md-nav__link">
    Optional extensions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replace-features" class="md-nav__link">
    Replace features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bundle-options" class="md-nav__link">
    Bundle options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-access" class="md-nav__link">
    Configuration access
  </a>
  
    <nav class="md-nav" aria-label="Configuration access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique-sub-config" class="md-nav__link">
    Unique sub config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-by-path" class="md-nav__link">
    Access by path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-configs" class="md-nav__link">
    Multiple configs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-configuration-analysis" class="md-nav__link">
    Custom configuration analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-state" class="md-nav__link">
    Shared state
  </a>
  
    <nav class="md-nav" aria-label="Shared state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#equal-communication-scenario" class="md-nav__link">
    Equal communication scenario
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parent-child-scenario" class="md-nav__link">
    Parent-child scenario
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beforeafter-run-logic" class="md-nav__link">
    Before/after run logic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        User guide
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="User guide" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          User guide
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/extensions/" class="md-nav__link">
        Extensions
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/web/" class="md-nav__link">
        Web
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/modules/" class="md-nav__link">
        Extra integrations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/bundles/" class="md-nav__link">
        Bundles
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/yaml-values/" class="md-nav__link">
        Yaml values
      </a>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_7" type="checkbox" id="__nav_3_7" >
      
      <label class="md-nav__link" for="__nav_3_7">
        Guice
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Guice" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_7">
          <span class="md-nav__icon md-icon"></span>
          Guice
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/guice/injector/" class="md-nav__link">
        Injector
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/guice/bindings/" class="md-nav__link">
        Bindings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/guice/scopes/" class="md-nav__link">
        Scopes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/guice/module-autowiring/" class="md-nav__link">
        Module autowiring
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/guice/module-analysis/" class="md-nav__link">
        Modules analysis
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/guice/override/" class="md-nav__link">
        Override bindings
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/guice/servletmodule/" class="md-nav__link">
        ServletModule
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_8" type="checkbox" id="__nav_3_8" >
      
      <label class="md-nav__link" for="__nav_3_8">
        Diagnostic
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Diagnostic" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_8">
          <span class="md-nav__icon md-icon"></span>
          Diagnostic
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/diagnostic-tools/" class="md-nav__link">
        Tools
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/configuration-report/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/configuration-model/" class="md-nav__link">
        Configuration model
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/installers-report/" class="md-nav__link">
        Installers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/yaml-values-report/" class="md-nav__link">
        Yaml values
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/lifecycle-report/" class="md-nav__link">
        Lifecycle
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/guice-report/" class="md-nav__link">
        Guice
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/aop-report/" class="md-nav__link">
        AOP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/web-report/" class="md-nav__link">
        Web
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/diagnostic/jersey-report/" class="md-nav__link">
        Jersey
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3_9" type="checkbox" id="__nav_3_9" >
      
      <label class="md-nav__link" for="__nav_3_9">
        Test
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Test" data-md-level="2">
        <label class="md-nav__title" for="__nav_3_9">
          <span class="md-nav__icon md-icon"></span>
          Test
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/test/overview/" class="md-nav__link">
        Overview
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/test/junit5/" class="md-nav__link">
        Junit 5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/test/spock/" class="md-nav__link">
        Spock
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/test/junit4/" class="md-nav__link">
        Junit 4
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/lifecycle/" class="md-nav__link">
        Lifecycle
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/scan/" class="md-nav__link">
        Classpath scan
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/installers/" class="md-nav__link">
        Installers
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/ordering/" class="md-nav__link">
        Ordering
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/options/" class="md-nav__link">
        Options
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/events/" class="md-nav__link">
        Events
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/disables/" class="md-nav__link">
        Disables
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/deduplication/" class="md-nav__link">
        De-duplication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/commands/" class="md-nav__link">
        Commands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/hooks/" class="md-nav__link">
        Hooks
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/shared/" class="md-nav__link">
        Shared state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../guide/hk2/" class="md-nav__link">
        HK2
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Installers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Installers" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Installers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/resource/" class="md-nav__link">
        Resource
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/task/" class="md-nav__link">
        Task
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/managed/" class="md-nav__link">
        Managed
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/lifecycle/" class="md-nav__link">
        Lifecycle
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/healthcheck/" class="md-nav__link">
        Health check
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/jersey-ext/" class="md-nav__link">
        Jersey extension
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/jersey-feature/" class="md-nav__link">
        Jersey feature
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/eager/" class="md-nav__link">
        Eager singleton
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/plugin/" class="md-nav__link">
        Plugin
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/servlet/" class="md-nav__link">
        Web servlet
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/filter/" class="md-nav__link">
        Web filter
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../installers/listener/" class="md-nav__link">
        Web listener
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Modules
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Modules" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Modules
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/bom/" class="md-nav__link">
        BOM
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/admin-rest/" class="md-nav__link">
        Admin REST
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/lifecycle-annotations/" class="md-nav__link">
        Lifecycle annotations
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/eventbus/" class="md-nav__link">
        Guava EventBus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/jdbi/" class="md-nav__link">
        JDBI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/jdbi3/" class="md-nav__link">
        JDBI3
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/spa/" class="md-nav__link">
        SPA
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/gsp/" class="md-nav__link">
        Server Pages
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../extras/validation/" class="md-nav__link">
        Validation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        Examples
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Examples" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Examples
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/authentication/" class="md-nav__link">
        Authentication
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/governator/" class="md-nav__link">
        Governator
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/hibernate/" class="md-nav__link">
        Hibernate
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/eventbus/" class="md-nav__link">
        EventBus
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/jdbi/" class="md-nav__link">
        JDBI
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../examples/jdbi3/" class="md-nav__link">
        JDBI3
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        About
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="About" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          About
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../about/release-notes/" class="md-nav__link">
        Release notes
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../about/compatibility/" class="md-nav__link">
        Compatibility
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../about/history/" class="md-nav__link">
        Version history
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../about/support/" class="md-nav__link">
        Support
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../about/license/" class="md-nav__link">
        License
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#guicey-bundle" class="md-nav__link">
    Guicey bundle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dropwizard-bundle" class="md-nav__link">
    Dropwizard bundle
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bundle-vs-module" class="md-nav__link">
    Bundle vs Module
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bundle-tips" class="md-nav__link">
    Bundle tips
  </a>
  
    <nav class="md-nav" aria-label="Bundle tips">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#uniqueness" class="md-nav__link">
    Uniqueness
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#auto-loaded-bundle" class="md-nav__link">
    Auto-loaded bundle
  </a>
  
    <nav class="md-nav" aria-label="Auto-loaded bundle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auto-load-override" class="md-nav__link">
    Auto load override
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-extensions" class="md-nav__link">
    Optional extensions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#replace-features" class="md-nav__link">
    Replace features
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bundle-options" class="md-nav__link">
    Bundle options
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-access" class="md-nav__link">
    Configuration access
  </a>
  
    <nav class="md-nav" aria-label="Configuration access">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#unique-sub-config" class="md-nav__link">
    Unique sub config
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#access-by-path" class="md-nav__link">
    Access by path
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiple-configs" class="md-nav__link">
    Multiple configs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-configuration-analysis" class="md-nav__link">
    Custom configuration analysis
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#shared-state" class="md-nav__link">
    Shared state
  </a>
  
    <nav class="md-nav" aria-label="Shared state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#equal-communication-scenario" class="md-nav__link">
    Equal communication scenario
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parent-child-scenario" class="md-nav__link">
    Parent-child scenario
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beforeafter-run-logic" class="md-nav__link">
    Before/after run logic
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/xvik/dropwizard-guicey/edit/master/src/doc/docs/decomposition.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="decomposition">Decomposition<a class="headerlink" href="#decomposition" title="Permanent link">&para;</a></h1>
<div class="admonition summary">
<p>Guide for writing re-usable bundles</p>
</div>
<p>In dropwizard we have only one decomposition element: <a href="https://www.dropwizard.io/en/stable/manual/core.html#bundles">ConfiguredBundle</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In pure dropwizard, bundles also used inside single application to separate configuration blocks
(simplify logic). In guicey, this is not required as <a href="../guide/scan/">classpath scan</a> could be
used for extensions registration (configuration amount reduced).</p>
<p>This chapter describe only re-usable logc decomposition.</p>
</div>
<p>In guicey we have: guicey bundle (<code>GuiceyBundle</code>), guice module (<code>Module</code>) and dropwizard bundle (<code>ConfiguredBundle</code>).
This could confuse.</p>
<ul>
<li>There are existing <a href="https://modules.dropwizard.io/thirdparty/">dropwizard modules</a> - <code>ConfiguredBundle</code></li>
<li>Existing <a href="https://github.com/google/guice/wiki/3rdPartyModules">guice modules</a> (outdated list, just as an exampel) - <code>Module</code></li>
<li>And <a href="../guide/modules/">guicey extensions</a> - <code>GuiceyBundle</code></li>
</ul>
<p>All these modules are supposed to be used together (obviously). In some cases, 
guicey explicitly provides wrapping modules (e.g. <a href="../extras/jdbi3/">jdbi</a> - wrapper for dropwizard module),
but such wrappers usually provide additional abilities (impossible with pure module) and
not driven by inability to use a raw module.</p>
<h2 id="guicey-bundle">Guicey bundle<a class="headerlink" href="#guicey-bundle" title="Permanent link">&para;</a></h2>
<p>As it <a href="../concepts/#bundles">was described</a>, guicey have to introduce its own <a href="../guide/bundles/">bundle</a> because guicey provides
additional configuration features (even in the simplest case you should be able to
configure guice modules).</p>
<p><em>Prefer <code>GuiceyBundle</code> over dropwizard <code>Bundle</code></em> for developing re-usable modules.
Of course, if module is very generic (does not depend on guice) you can do pure dropwizard module
(to publish it for wider audience), but almost always bundles rely on guicey features.</p>
<p>Benefits:</p>
<ul>
<li>guice support (ability to register guice modules)</li>
<li><a href="../guide/options/">options</a> support</li>
<li>could use <a href="../guide/yaml-values/#unique-sub-configuration">sub-configration objects</a> directly (important for writing generic modules)</li>
<li>ability to introduce new <a href="../guide/extensions/">extension types</a> to simplify usage (e.g. like <a href="../extras/jdbi3/">jdbi</a>)</li>
<li><a href="../concepts/#bundles-lookup">automatic module load</a> when jar appear in classpath (e.g. like <a href="../extras/lifecycle-annotations/">lifecycle annotations</a>)</li>
<li><a href="../guide/shared/">shared state</a> - advanced technique for bundles communications (e.g. used by <a href="../extras/gsp/">GSP</a> and <a href="../extras/spa/">SPA</a>)</li>
<li><a href="../guide/events/">events</a> - internal lifecycle events for fine-tuning lifecycle (again, complex cases only, for example, <a href="../extras/gsp/">GSP</a> use it to order bundles logic)</li>
<li>ability to replace functionality (prevent feature x registration by <a href="../guide/disables/">disabling it</a> and register feature y instead)</li>
</ul>
<h2 id="dropwizard-bundle">Dropwizard bundle<a class="headerlink" href="#dropwizard-bundle" title="Permanent link">&para;</a></h2>
<p>It is important to note that there is a difference between registration of dropwizard bundle directly
(in dropwizard <code>Bootstrap</code>) and through guicey api: bundle registered through guicey api
<a href="../guide/disables/#disable-dropwizard-bundles">could be disabled</a>, <a href="../guide/deduplication/#dropwizard-bundles">de-duplicated</a>,
tracked for <a href="../guide/bundles/#transitive-bundles-tracking">transitive bundles</a>.</p>
<p>Also, bundles registered through guicey api appear in <a href="../guide/diagnostic/configuration-report/">configuration report</a>.</p>
<p>There is a difference between dropwizard and guicey bundles in transitive bundles initialization: </p>
<p><em>Dropwizard bundle</em> <strong>immediately</strong> initialize transitive bundle:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBundle</span> <span class="kd">implements</span> <span class="n">ConfiguredBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">Bootstrap</span><span class="o">&lt;?&gt;</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">bootstrap</span><span class="p">.</span><span class="na">addBundle</span><span class="p">(</span><span class="k">new</span> <span class="n">MyOtherBundle</span><span class="p">());</span>  

            <span class="c1">// line executed after MyOtherBundle init</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p><em>Guicey bundle</em> register transitive bundle <strong>after</strong> current bundle, but dropwizard bundle immediately.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">bootstrap</span>
                <span class="p">.</span><span class="na">dropwizardBundles</span><span class="p">(</span><span class="k">new</span> <span class="n">DwBundle</span><span class="p">())</span>
                <span class="p">.</span><span class="na">bundles</span><span class="p">(</span><span class="k">new</span> <span class="n">MyOtherBundle</span><span class="p">());</span>

            <span class="c1">// line executed before MyOtherBundle init, but after DwBundle init</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Guicey bundles behaviour explained by <a href="../guide/deduplication/">de-duplciation</a> logic:
registered root bundles must be initialized in priority. It avoids situation like:</p>
<div class="highlight"><pre><span></span><code><span class="n">GuiceBundle</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
    <span class="p">.</span><span class="na">bundles</span><span class="p">(</span><span class="k">new</span> <span class="n">Bundle1</span><span class="p">(),</span> <span class="k">new</span> <span class="n">Bundle2</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
</code></pre></div>
<p>If <code>Bundle2</code> is unique and <code>Bundle1</code> transitively installs <code>new Bundle2(1)</code> (e.g. with different config),
then this transitive bundle would be ignored (because root bundles init will appear first).
If it were working like dropwizard bundles, then directly registered <code>Bundle2</code> would be ignored
and remaining instance would have different configuration (confusion point).  </p>
<p>Normally, this behaviour should not be an issue as you shouldn't rely on bundles initialization order.
But this may be important with <a href="#shared-state">shared state</a>.</p>
<h2 id="bundle-vs-module">Bundle vs Module<a class="headerlink" href="#bundle-vs-module" title="Permanent link">&para;</a></h2>
<p>When extracting functionality into re-usable module always start with a bundle.
Guice module, most likely, will be required too.</p>
<p>Logic should be separated as:</p>
<ul>
<li><em>Guice module</em> is responsible for guice bindings and should not be aware of dropwizard. </li>
<li><em>Bundle</em> works with dropwizard: extract required configuration for creating module and do other registrations.</li>
</ul>
<p>That's an ideal case. But, for example, if you need to apply some bindings based on configuration only 
then you can do it with pure guice module, like:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModuleConfig</span> <span class="p">{</span>  
    <span class="nd">@JsonProperty</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">something</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre></div>
<p>Module knows that target application (where this re-usable module would be used) will declare
this configuration inside its main configuration:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AppConfig</span> <span class="kd">extends</span> <span class="n">Configuration</span> <span class="p">{</span>
    <span class="nd">@JsonProperty</span>    
    <span class="kd">private</span> <span class="n">ModuleConfig</span> <span class="n">module</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<p>Make module <a href="../guide/guice/module-autowiring/#autowiring-base-class">aware of dropwizard staff</a>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModuleImpl</span><span class="o">&lt;</span><span class="n">C</span> <span class="kd">extends</span> <span class="n">Configuration</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">DropwizardAwareModule</span><span class="o">&lt;</span><span class="n">C</span><span class="o">&gt;</span> <span class="p">{</span>

     <span class="nd">@Override</span>
     <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// obtain sub-configuration object </span>
        <span class="n">ModuleConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="n">Preconditions</span><span class="p">.</span><span class="na">checkNotNull</span><span class="p">(</span><span class="n">configuration</span><span class="p">(</span><span class="n">ModuleConfig</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
                <span class="s">&quot;ModuleConfig is not found within application config. Please declare it.&quot;</span><span class="p">);</span>

        <span class="c1">// use it for binding    </span>
        <span class="n">bind</span><span class="p">(</span><span class="n">SomeService</span><span class="p">.</span><span class="na">class</span><span class="p">).</span><span class="na">annotatedWith</span><span class="p">(</span><span class="n">Names</span><span class="p">.</span><span class="na">named</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="na">getSomething</span><span class="p">())).</span><span class="na">to</span><span class="p">(</span><span class="n">SomeServiceImpl</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>                            
     <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is not a recommended way! It was shown just to demonstrate that guice module <em>could</em> be used
without bundle. It's better to use declaration bundle instead:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModuleImpl</span> <span class="kd">extends</span> <span class="n">AbstractBundle</span> <span class="p">{</span>

     <span class="kd">private</span> <span class="n">ModuleConfig</span> <span class="n">config</span><span class="p">;</span>

     <span class="kd">public</span> <span class="nf">ModuleImpl</span><span class="p">(</span><span class="n">ModuleConfig</span> <span class="n">config</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">config</span> <span class="o">=</span> <span class="n">config</span><span class="p">;</span>
     <span class="p">}</span>        

     <span class="nd">@Override</span>
     <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">configure</span><span class="p">()</span> <span class="p">{</span>                    
        <span class="n">bind</span><span class="p">(</span><span class="n">SomeService</span><span class="p">.</span><span class="na">class</span><span class="p">).</span><span class="na">annotatedWith</span><span class="p">(</span><span class="n">Names</span><span class="p">.</span><span class="na">named</span><span class="p">(</span><span class="n">config</span><span class="p">.</span><span class="na">getSomething</span><span class="p">())).</span><span class="na">to</span><span class="p">(</span><span class="n">SomeServiceImpl</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>                            
     <span class="p">}</span>
<span class="p">}</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ModuleBundle</span> <span class="kd">extends</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>   
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="n">GuiceyEnvironment</span> <span class="n">environment</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
         <span class="n">ModuleConfig</span> <span class="n">config</span> <span class="o">=</span> <span class="n">Preconditions</span><span class="p">.</span><span class="na">checkNotNull</span><span class="p">(</span><span class="n">environment</span><span class="p">.</span><span class="na">configuration</span><span class="p">(</span><span class="n">ModuleConfig</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
                    <span class="s">&quot;ModuleConfig is not found within application config. Please declare it.&quot;</span><span class="p">);</span>

          <span class="n">environment</span><span class="p">.</span><span class="na">modules</span><span class="p">(</span><span class="k">new</span> <span class="n">ModuleImpl</span><span class="p">(</span><span class="n">config</span><span class="p">));</span>          
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</div>
<h2 id="bundle-tips">Bundle tips<a class="headerlink" href="#bundle-tips" title="Permanent link">&para;</a></h2>
<p>These tips show various techniques for developing bundles.<br />
Mostly, these tips are based on developing <a href="https://github.com/xvik/dropwizard-guicey-ext">guicey extensions</a>.
(look extensions sources as examples).</p>
<h3 id="uniqueness">Uniqueness<a class="headerlink" href="#uniqueness" title="Permanent link">&para;</a></h3>
<p>For everything that is registered "by instance" applied <a href="../guide/deduplication/">de-duplication mechanism</a>.</p>
<p>You can use it to grant only one instance of <a href="../guide/bundles/#de-duplication">bundle</a> by <code>extends UniqueGuiceyBundle</code>
(or more sophisticated logic by manual <a href="../guide/deduplication/#equals-method">equals and hash code implementation</a>,
for example, to de-duplicate only instance with the same constructor arguments).</p>
<p>It may be mostly important for <a href="../guide/deduplication/#guice-modules">guice modules</a> as guice will not start with duplicate bundings
(<code>MyModule extends UniqueModule</code>).</p>
<h3 id="auto-loaded-bundle">Auto-loaded bundle<a class="headerlink" href="#auto-loaded-bundle" title="Permanent link">&para;</a></h3>
<p>Auto loading based on guicey <a href="../guide/bundles/#service-loader-lookup">bundles lookup</a>.</p>
<p>Be aware that user may switch off bundles lookup (with <code>.disableBundleLookup()</code>) or apply <a href="../guide/bundles/#customizing-lookup-mechanism">custom lookup</a>).</p>
<h4 id="auto-load-override">Auto load override<a class="headerlink" href="#auto-load-override" title="Permanent link">&para;</a></h4>
<p>If your bundle provides configuration, but you still want to load it automatically with the default configuration,
then you can use <a href="../guide/bundles/#de-duplication">bundle uniquness</a>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">AutoLoadableBundle</span> <span class="kd">extends</span> <span class="n">UniqueGuiceyBundle</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
</code></pre></div>
<p>Now only one bundle instance is allowed and, if user register bundle manually,
bundle from lookup will simply be ignored. <a href="../extras/lifecycle-annotations/">Lifecycle annotations</a> module use this technique.</p>
<h3 id="optional-extensions">Optional extensions<a class="headerlink" href="#optional-extensions" title="Permanent link">&para;</a></h3>
<p>All extensions must be registered under initialization phase, when configuration is not yet available
and so it is not possible to implement optional extension registration. </p>
<p>To workaround this, you can conditionally disable extensions:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFeatureBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>   
        <span class="c1">// always register extension</span>
        <span class="n">bootstrap</span><span class="p">.</span><span class="na">extensions</span><span class="p">(</span><span class="n">OptionalExtension</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>     
    <span class="p">}</span>   

    <span class="nd">@Override</span>    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="n">GuiceyEnvironment</span> <span class="n">environment</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
        <span class="c1">// disable extension based on configuration value</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">environment</span><span class="p">.</span><span class="na">configuration</span><span class="p">().</span><span class="na">getSomeValue</span><span class="p">())</span> <span class="p">{</span>
            <span class="n">environment</span><span class="p">.</span><span class="na">disableExtension</span><span class="p">(</span><span class="n">OptionalExtension</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="replace-features">Replace features<a class="headerlink" href="#replace-features" title="Permanent link">&para;</a></h3>
<p>As bundle has almost complete access to configuration, it can use <a href="../guide/disables/">disables</a>
to substitute application functions.</p>
<p>For example, it is known that application use <code>ServiceX</code> (from some core module in organization),
but this bundle requires modified service. It can disable core module, installing feature 
and register customized module:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyFeatureBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>           
        <span class="n">bootstrap</span>
            <span class="p">.</span><span class="na">disableModules</span><span class="p">(</span><span class="n">CoreModule</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
            <span class="p">.</span><span class="na">modules</span><span class="p">(</span><span class="k">new</span> <span class="n">CustomizedCoreModule</span><span class="p">());</span>     
    <span class="p">}</span>      
<span class="p">}</span>      
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It's not the best example: of course it's simpler to use <a href="../guide/guice/override/">binding override</a>
to override single service. But it's just to demonstrate the idea (it could be repalced
extension or fixed installer). </p>
<p>Bundles can't disable other bundles (because target bundle could be already processed at this point).   </p>
</div>
<h3 id="bundle-options">Bundle options<a class="headerlink" href="#bundle-options" title="Permanent link">&para;</a></h3>
<p>Bundle could use guicey <a href="../guide/options/">options mechanism</a> to access guicey option values:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">bootstrap</span><span class="p">.</span><span class="na">option</span><span class="p">(</span><span class="n">GuiceyOptions</span><span class="p">.</span><span class="na">UseHkBridge</span><span class="p">))</span> <span class="p">{</span>
            <span class="c1">// show warning that bridge required</span>
        <span class="p">}</span> 
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Or it could be some <a href="../guide/options/#custom-options">custom options</a> usage.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Option values are set only in main <code>GuiceBundle</code> and so all bundles see the same option values
(no one can change values after).</p>
</div>
<h3 id="configuration-access">Configuration access<a class="headerlink" href="#configuration-access" title="Permanent link">&para;</a></h3>
<p>Bundle could access not only direct dropwizard <code>Configuration</code>, but also individual values<br />
thanks to <a href="../guide/yaml-values/">yaml values</a> introspection.</p>
<h4 id="unique-sub-config">Unique sub config<a class="headerlink" href="#unique-sub-config" title="Permanent link">&para;</a></h4>
<p>When creating re-usable bundle it is often required to access yaml configuration data. 
Usually this is solved by some "configuration lookups" like in <a href="https://www.dropwizard.io/en/release-2.0.x/manual/views.html">dropwizard-views</a> </p>
<p>Guicey allows you to obtain sub-configuration object directly:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XFeatureBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="n">GuiceyEnvironment</span> <span class="n">environment</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
        <span class="n">XFeatureConfig</span> <span class="n">environment</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">.</span><span class="na">configuration</span><span class="p">(</span><span class="n">XFeatureConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Note that this bundle doesn't known exact type of user configuration, it just 
assumes that <code>XFeatureConfig</code> is declared somewhere in configuration (on any level)
just once. For example:</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyConfig</span> <span class="kd">extends</span> <span class="n">Configuration</span> <span class="p">{</span>

    <span class="nd">@JsonProperty</span>
    <span class="kd">private</span> <span class="n">XFeatureConfig</span> <span class="n">xfeature</span><span class="p">;</span>

    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Your sub configuration object must appear only once within user configuration.</p>
<p>Object uniqueness checked by exact type match, so if configuration also 
contains some extending class (<code class="highlight"><span class="n">XFeatureConfigExt</span> <span class="kd">extends</span> <span class="n">XFeatureConfig</span></code>) 
it will be different unique config. </p>
</div>
<h4 id="access-by-path">Access by path<a class="headerlink" href="#access-by-path" title="Permanent link">&para;</a></h4>
<p>When you are not sure that configuration is unique, you can rely on exact path definition
(of required sub configuration):</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XFeatureBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="n">String</span> <span class="n">path</span><span class="p">;</span>

    <span class="kd">public</span> <span class="nf">XFeatureBundle</span><span class="p">(</span><span class="n">String</span> <span class="n">path</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="na">path</span> <span class="o">=</span> <span class="n">path</span><span class="p">;</span>
    <span class="p">}</span> 

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="n">GuiceyEnvironment</span> <span class="n">environment</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
        <span class="n">XFeatureConfig</span> <span class="n">conf</span> <span class="o">=</span> <span class="n">environment</span><span class="p">.</span><span class="na">configuration</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Path is declared by bundle user, who knows required configuration location:</p>
<div class="highlight"><pre><span></span><code><span class="n">GuiceBundle</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
    <span class="p">.</span><span class="na">bundles</span><span class="p">(</span><span class="k">new</span> <span class="n">XFeatureBundle</span><span class="p">(</span><span class="s">&quot;sub.feature&quot;</span><span class="p">))</span>
    <span class="p">...</span>
    <span class="p">.</span><span class="na">build</span><span class="p">()</span>
</code></pre></div>
<p>Where </p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyConfig</span> <span class="kd">extends</span> <span class="n">Configuration</span> <span class="p">{</span>

    <span class="nd">@JsonProperty</span>
    <span class="kd">private</span> <span class="n">SubConfig</span> <span class="n">sub</span> <span class="o">=</span> <span class="p">{</span> <span class="c1">// pseudo code to combine class declarations</span>
         <span class="nd">@JsonProperty</span>
         <span class="kd">private</span> <span class="n">XFeatureConfig</span> <span class="n">feature</span><span class="p">;</span>   
    <span class="p">}</span>

    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="multiple-configs">Multiple configs<a class="headerlink" href="#multiple-configs" title="Permanent link">&para;</a></h4>
<p>In case, when multiple config objects could be declared in user configuration,
you can access all of them: </p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XFeatureBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="n">GuiceyEnvironment</span> <span class="n">environment</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">XFeatureConfig</span><span class="o">&gt;</span> <span class="n">confs</span> <span class="o">=</span> <span class="n">environment</span><span class="p">.</span><span class="na">configurations</span><span class="p">(</span><span class="n">XFeatureConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>For configuration</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyConfig</span> <span class="kd">extends</span> <span class="n">Configuration</span> <span class="p">{</span>

    <span class="nd">@JsonProperty</span>
    <span class="kd">private</span> <span class="n">XFeatureConfig</span> <span class="n">xfeature</span><span class="p">;</span>
    <span class="nd">@JsonProperty</span>
    <span class="kd">private</span> <span class="n">XFeatureConfig</span> <span class="n">xfeature2</span><span class="p">;</span>

    <span class="p">...</span>
<span class="p">}</span>
</code></pre></div>
<p>It wil return both objects: <code>[xfeature, xfeature2]</code></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In contrast to unique configurations, this method returns all subclasses too.
So if there are <code class="highlight"><span class="n">XFeatureConfigExt</span> <span class="kd">extends</span> <span class="n">XFeatureConfig</span></code> declared somewhere it will also be returned.</p>
</div>
<h4 id="custom-configuration-analysis">Custom configuration analysis<a class="headerlink" href="#custom-configuration-analysis" title="Permanent link">&para;</a></h4>
<p>In all other cases (with more complex requirements) you can use <code>ConfigurationTree</code> object which
represents introspected configuration paths.  </p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">XFeatureBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="n">GuiceyEnvironment</span> <span class="n">environment</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="p">{</span>
         <span class="c1">// get all properties of custom configuration (ignoring properties from base classes)</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">ConfigPath</span><span class="o">&gt;</span> <span class="n">paths</span> <span class="o">=</span> <span class="n">environment</span><span class="p">.</span><span class="na">configurationTree</span><span class="p">()</span>
                <span class="p">.</span><span class="na">findAllRootPathsFrom</span><span class="p">(</span><span class="n">MyConfig</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

        <span class="c1">// search for not null values of marked (annotated) classes            </span>
        <span class="n">List</span> <span class="n">markedTypes</span> <span class="o">=</span> <span class="n">paths</span><span class="p">.</span><span class="na">stream</span><span class="p">()</span>
            <span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">it</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="p">.</span><span class="na">getValue</span><span class="p">()</span> <span class="o">!=</span> <span class="kc">null</span> 
                    <span class="o">&amp;&amp;</span> <span class="n">it</span><span class="p">.</span><span class="na">getType</span><span class="p">().</span><span class="na">getValueType</span><span class="p">().</span><span class="na">hasAnnotation</span><span class="p">(</span><span class="n">MyMarker</span><span class="p">.</span><span class="na">class</span><span class="p">))</span>
            <span class="p">.</span><span class="na">map</span><span class="p">(</span><span class="n">it</span> <span class="o">-&gt;</span> <span class="n">it</span><span class="p">.</span><span class="na">getValue</span><span class="p">())</span>
            <span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">());</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In this example, bundle search for properties declared directly in <code>MyConfig</code> configuration
class with not null value and annotated (classes annotated, not properties!) with custom marker (<code>@MyMarker</code>).  </p>
<p>See introspected configuration <a href="../guide/yaml-values/#introspected-configuration">structure description</a>.</p>
<h3 id="shared-state">Shared state<a class="headerlink" href="#shared-state" title="Permanent link">&para;</a></h3>
<p>Guicey maintains special shared state object useful for storing application-wide data.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Yes, any shared state is a "hack". Normally, you should avoid using it. 
Guicey provides this ability to unify all such current and future hacks:
so if you need to communicate between bundles - you don't need to reinvent the wheel
and don't have additional problems in tests (due to leaking states).</p>
</div>
<p>For example, it is used by <a href="../extras/spa/">spa bundle</a> to share list of registered
application names between all spa bundle instances and so be able to prevent duplicate name registration.</p>
<p><a href="../extras/gsp/">Server pages bundle</a> use shared state to maintain global configuration
and allow application bundles communication with global views bundle. </p>
<h4 id="equal-communication-scenario">Equal communication scenario<a class="headerlink" href="#equal-communication-scenario" title="Permanent link">&para;</a></h4>
<p>Case when multiple (equal) bundles need to communicate. In this case first initialized
bundle init shared state and others simply use it.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EqualBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// either obtain already shared object or share new object                                                             </span>
        <span class="n">SomeState</span> <span class="n">state</span> <span class="o">=</span> <span class="n">bootstrap</span><span class="p">.</span><span class="na">sharedState</span><span class="p">(</span><span class="n">EqualBundle</span><span class="p">,</span> <span class="p">()</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="n">SomeState</span><span class="p">());</span>
        <span class="p">...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="parent-child-scenario">Parent-child scenario<a class="headerlink" href="#parent-child-scenario" title="Permanent link">&para;</a></h4>
<p>Case when there is one global bundle, which must initialize some global state and child 
bundles, which use or appends to this global state.</p>
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GlobalBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// share global state object</span>
        <span class="n">bootstrap</span><span class="p">.</span><span class="na">shareState</span><span class="p">(</span><span class="n">GlobalBundle</span><span class="p">,</span> <span class="k">new</span> <span class="n">GlobalState</span><span class="p">());</span>
    <span class="p">}</span>        
<span class="p">}</span>    

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">ChildBundle</span> <span class="kd">implements</span> <span class="n">GuiceyBundle</span> <span class="p">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// access shared object or fail when not found</span>
        <span class="n">GlobalState</span> <span class="n">state</span> <span class="o">=</span> <span class="n">environment</span><span class="p">.</span><span class="na">sharedStateOrFail</span><span class="p">(</span><span class="n">GlobalBundle</span><span class="p">,</span> 
                <span class="s">&quot;Failed to obtain global state - check if global bundle registered&quot;</span><span class="p">);</span>
    <span class="p">}</span>        
<span class="p">}</span>
</code></pre></div>
<h3 id="beforeafter-run-logic">Before/after run logic<a class="headerlink" href="#beforeafter-run-logic" title="Permanent link">&para;</a></h3>
<p>If multiple bundles must be synchronized on run phase, use <a href="../guide/events/">guicey events</a>. </p>
<p>To run code after all guicey bundles initialization, but before run:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">initialize</span><span class="p">(</span><span class="kd">final</span> <span class="n">GuiceyBootstrap</span> <span class="n">bootstrap</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">bootstrap</span><span class="p">.</span><span class="na">listen</span><span class="p">(</span><span class="k">new</span> <span class="n">GuiceyLifecycleAdapter</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">beforeRun</span><span class="p">(</span><span class="kd">final</span> <span class="n">BeforeRunEvent</span> <span class="n">event</span><span class="p">)</span>  <span class="p">{</span>
            <span class="c1">// do something before bundles run</span>
            <span class="c1">// NOTE that environment and configuration already available!</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<p>To run code after all guicey bundles run methods (delayed init):</p>
<div class="highlight"><pre><span></span><code><span class="nd">@Override</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">(</span><span class="kd">final</span> <span class="n">GuiceyEnvironment</span> <span class="n">environment</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">environment</span><span class="p">.</span><span class="na">listen</span><span class="p">(</span><span class="k">new</span> <span class="n">GuiceyLifecycleAdapter</span><span class="p">()</span> <span class="p">{</span>
        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">bundlesStarted</span><span class="p">(</span><span class="kd">final</span> <span class="n">BundlesStartedEvent</span> <span class="n">event</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// still sdropwizard run phase (anything could be configured)</span>
            <span class="c1">// but all guicey bundles aready executed </span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This will work only for guicey bundles! Registered dropwizard bundles may
execute before or after these events: events broadcast from main dropwizard 
<code>GuiceBundle</code> run method, so other dropwizard bundles, registered after guice bundle
will run after it. 
It is assumed that guicey bundles used for most configurations (especially in complex
cases when bundles synchronization is required)). </p>
</div>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../tests/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Testing
            </div>
          </div>
        </a>
      
      
        <a href="../guide/configuration/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Configuration
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2014-2021 Vyacheslav Rusakov
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/xvik" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/vyarus" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>